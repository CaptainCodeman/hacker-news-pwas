var c,f=/^\/$|top|new|show|ask|job/,g=/story\/(\d+$)/,h="undefined"!==typeof window;"undefined"!==typeof document&&(c=document.querySelector("#app"),document.body.addEventListener("click",function(a){var b=a.target;b.classList.contains("page")&&(a.preventDefault(),history.pushState({offset:0},"",""+b.getAttribute("href")),l(b.dataset.scope));b.classList.contains("comments")&&(a.preventDefault(),a=b.href.match(g)[1],history.pushState({a:a},"","/story/"+a),n(a))}));
function l(a){var b=c;p(a).then(function(a){return q(b,a)})}function q(a,b){a.innerHTML="";r=r.bind(this);a.appendChild(b.reduce(function(a,b){return a.appendChild(t(b))&&a},r("ul",{id:"stories"})))}function u(a,b){return fetch(a+".json"+(void 0===b?"":b)).then(function(a){return a.json()})}function v(a,b,d){d.filter(function(a){return!a.deleted}).map(w).forEach(function(d){a.appendChild(d);b&&x(d.kids,a)})}function x(a,b){a&&a.length&&u("/items","?ids="+a.join(",")).then(v.bind(null,b,!0))}
function w(a){var b=r("ul",{className:"kid-root","data-story-id":a.id},r("li",{},r("div",{className:"comment-info sub-info"},r("div",{className:"author"},a.by)),r("p",{className:"comment-text",innerHTML:a.text})));x(a.kids,b);return b}
function n(a){c.innerHTML="";u("https://hacker-news.firebaseio.com/v0/item/"+a).then(function(a){var b=r("div",{className:"story-root"},t(a,"div",!0));c.appendChild(b);u("/items","?ids="+a.kids.join(",")).then(function(a){var d=r("ul",{className:"root"});v(d,!1,a);b.appendChild(d)})})}
function p(a){var b=0,d,b=void 0===b?0:b;d=void 0===d?30:d;return new Promise(function(k){var e=new XMLHttpRequest;e.addEventListener("load",function(){k(JSON.parse(this.responseText))});e.open("GET","/stories.json?scope="+a+"&offset="+b+"&num="+d);e.send()})}function r(a,b,d){b=b?b:{};var k=this,e=this.document.createElement(a),m;for(m in b)e[m]=b[m];Array.from(arguments).slice(2).forEach(function(a){return e.appendChild("string"===typeof a?k.document.createTextNode(a||""):a)});return e}
function t(a,b,d){d=void 0===d?!1:d;return r(void 0===b?"li":b,{className:"story"},r("div",{className:"headline"},r("div",{hidden:void 0===a.idx},a.idx+1+"."),r("div",{},r("a",{href:a.url||"/story/"+a.id,className:"title"},a.title),r("div",{className:"sub-info"},r("div",{},a.score+" points |"),r("div",{},"by "+a.by+" |"),r("a",{className:"comments",href:"/story/"+a.id,hidden:void 0===a.descendants},a.descendants+" comments")))),r("div",{className:"story-text",innerHTML:a.text,hidden:!(d&&void 0!==
a.text)}))}if(h)if(window.onpopstate=function(a){void 0!==a.state.offset?(a=window.location.pathname.match(f),l(("/"===a[0]?"top":a[0])+"stories")):n(a.state.a)},match=window.location.pathname.match(f)){var y="/"===match[0]?"top":match[0];history.replaceState({offset:0},"","/"+y);l(y+"stories")}else{var z=window.location.pathname.match(g)[1];history.pushState({a:z},"","/story/"+z);n(z)}"undefined"!==typeof module&&(module.b={c:q});
