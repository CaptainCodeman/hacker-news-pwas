var c=document.querySelector("#app"),e=/^\/$|top|newest|show|ask|jobs/;document.body.addEventListener("click",function(a){var b=a.target;b.classList.contains("page")&&(a.preventDefault(),history.pushState({offset:0},"",""+b.getAttribute("href")),f(0,b.dataset.scope));b.classList.contains("comments")&&(a.preventDefault(),a=b["story-id"],history.pushState({a:a},"","/story/"+a),g(a))});function h(a,b){return fetch(a+".json"+(void 0===b?"":b)).then(function(a){return a.json()})}
function m(a,b,d){d.filter(function(a){return!a.deleted}).map(n).forEach(function(d){a.appendChild(d);b&&p(d.kids,a)})}function p(a,b){a&&a.length&&h("/items","?ids="+a.join(",")).then(m.bind(null,b,!0))}function n(a){var b=q("ul",{className:"kid-root","story-id":a.id},q("li",{},q("div",{className:"comment-info sub-info"},q("div",{className:"author"},a.by)),q("p",{className:"comment-text",innerHTML:a.text})));p(a.kids,b);return b}
function g(a){c.innerHTML="";h("https://hacker-news.firebaseio.com/v0/item/"+a).then(function(a){var b=q("div",{className:"story-root"},r(a,"div",!0));c.appendChild(b);h("/items","?ids="+a.kids.join(",")).then(function(a){var d=q("ul",{className:"root"});m(d,!1,a);b.appendChild(d)})})}function q(a,b,d){b=b?b:{};var k=document.createElement(a),l;for(l in b)k[l]=b[l];Array.from(arguments).slice(2).forEach(function(a){return k.appendChild("string"===typeof a?new Text(a):a)});return k}
function r(a,b,d){d=void 0===d?!1:d;return q(void 0===b?"li":b,{className:"story"},q("div",{className:"headline"},q("div",{hidden:void 0===a.idx},a.idx+1+"."),q("div",{},q("a",{href:a.url||"/story/"+a.id,className:"title"},a.title,q("div",{className:"sub-info"},q("div",{},a.score+" points |"),q("div",{},"by "+a.by+" |"),q("a",{"story-id":a.id,className:"comments",href:"/story/"+a.id,hidden:void 0===a.descendants},a.descendants+" comments"))))),q("div",{className:"story-text",innerHTML:a.text,hidden:!(d&&
void 0!==a.text)}))}function f(a,b){c.innerHTML="";h("/stories","?scope="+b+"&offset="+(void 0===a?0:a)+"&num=30").then(function(a){c.appendChild(a.reduce(function(a,b){return a.appendChild(r(b))&&a},q("ul",{id:"stories"})))})}window.onpopstate=function(a){if(void 0!==a.state.offset){var b=window.location.pathname.match(e);f(a.state.offset,("/"===b[0]?"top":b[0])+"stories")}else g(a.state.a)};
if(match=window.location.pathname.match(e)){var t="/"===match[0]?"top":match[0];history.replaceState({offset:0},"","/"+t);f(0,t+"stories")}else{var u=window.location.pathname.match(/story\/(\d+)/)[1];history.pushState({a:u},"","/story/"+u);g(u)};
